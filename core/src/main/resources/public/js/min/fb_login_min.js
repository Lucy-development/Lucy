function redirectToChat(){window.location="http://lucy-messaging.herokuapp.com"}function redirectToLogin(){window.location="http://lucy-messaging.herokuapp.com/login.html"}function sendAuthRequest(e,t,o){var n="http://lucy-messaging.herokuapp.com/login",s={};s.authmethod="fb",s.userid=e,s.accesstoken=t,s.myname=o,document.cookie="myName="+o,document.cookie="myLid="+e,req=new XMLHttpRequest,req.open("POST",n,!0),req.setRequestHeader("Content-type","application/x-www-form-urlencoded"),req.onreadystatechange=function(){4==req.readyState&&(console.log("Facebook authentication request received a response from server: "+req.status+" "+req.statusText),req.status>=200&&req.status<300?(console.log("Facebook authentication request approved by server"),redirectToChat()):req.status>=400&&req.status<500?(console.log("Facebook authentication request declined by server"),redirectToLogin()):console.log("Unexpected response received from server. Aborting authentication."))},req.send(JSON.stringify(s))}function statusChangeHandler(e){console.log("FB API returned response: "+e.status),"connected"===e.status&&FB.api("/me",function(t){sendAuthRequest(e.authResponse.userID,e.authResponse.accessToken,t.name)})}function newLoginButtonHandler(){console.log("Attempting FB login"),FB.login(function(e){statusChangeHandler(e)},{scope:"public_profile"})}